function Class(e){$.extend(this,e)}function openChrome(){try{checkSupport&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),Components.classes["@mozilla.org/file/directory_service;1"].getService(Components.interfaces.nsIProperties).get("UChrm",Components.interfaces.nsILocalFile).reveal()}catch(e){showNotSupport()}}function showNotSupport(){alert("about:config中 signed.applets.codebase_principal_support 禁止了该行为")}Class.prototype.constructor=Class,Class.extend=function(e){function n(){t.apply(this,arguments),this.init&&this.init(e)}var t=this;return n.prototype=Object.create(t.prototype),$.extend(n.prototype,e),n.prototype.constructor=n,n};var jsFormat=function(e){return js_beautify(e,{indent_size:4,indent_char:" "})},toString=function(){function e(e){for(var n=0;n<t.length;n+=2)e=e.replace(t[n],t[n+1]);return'"'+e+'"'}function n(t){var a,o;switch(typeof t){case"string":return e(t);case"number":case"boolean":return t+"";case"object":if(!t)return"null";if(a=[],t instanceof Array){if(1==t.length&&null==t[0])return"[null]";for(o=0;o<t.length;o++)a[o]=null==t[o]?"":n(t[o]);return"["+a.join()+"]"}for(o in t)a[a.length]=o+":"+n(t[o]);return"{"+a.join()+"}";case"undefined":return"null";case"function":case"regexp":return t.toString();default:throw Error(typeof t)}}var t=[/(?=["\\])/g,"\\",/\n/g,"\\n",/\r/g,"\\r",/\t/g,"\\t"];return n}(),allCommands=[];$.each(Data,function(e,n){allCommands.push({name:n.label,value:e,title:n.tooltiptext||n.label})});var menu={styles:[{name:"页面右键",value:"page",title:"page"},{name:"标签右键",value:"tab",title:"tab"},{name:"工具菜单",value:"tool",title:"tool"},{name:"app菜单",value:"app",title:"ff28 以下为 firefox 橙菜单，以上为文件菜单"},{name:"页面右键二级",value:"PageMenu",title:"PageMenu"},{name:"标签右键二级",value:"TabMenu",title:"TabMenu"},{name:"工具菜单二级",value:"ToolMenu",title:"ToolMenu"},{name:"app菜单二级",value:"AppMenu",title:"AppMenu"}],types:[{name:"所有",value:""},{name:"复制",value:"copy"},{name:"搜索",value:"search"},{name:"打开",value:"open"},{name:"选取",value:"select"},{name:"链接",value:"link"},{name:"图像",value:"image"},{name:"输入框",value:"_input"},{name:"标签",value:"tab"},{name:"书签小工具",value:"_bookmark"},{name:"视频下载",value:"videodownload"},{name:"外部程序",value:"_app"},{name:"uc脚本",value:"ucjs"},{name:"扩展",value:"addon"},{name:"左中右三建",value:"click"}],commands:allCommands},checkSupport="chrome:"!==location.protocol;new(MenuCtrl=Class.extend({model:menu,style:"page",type:"",command:menu.commands[0].value,text:"",lineCount:0,selectedCommands:{},init:function(){rivets.bind($("#ucjsAddmenu"),this)},selectedChanged:function(e,n){var t=0===n.style.toLowerCase().indexOf("page"),a=$("#menuType").val().toLowerCase();n.model.commands=allCommands.filter(function(e){return(t?!0:"p"!==e.value.toLowerCase().slice(0,1))&&(a?-1!==e.value.toLowerCase().indexOf(a):!0)});var o=n.model.commands[0];n.command=o&&o.value},filterCommand:function(){},add:function(e,n,t){if(!t){var a=Data[n.command];n.selectedCommands[n.command]=toString(a),a.keyword&&setTimeout(function(){alert('本条目包含搜索关键字，请先检查自己的搜索中是否包含 "'+a.keyword+'" 关键字')})}var o=[];$.each(n.selectedCommands,function(e,n){n&&o.push(n)});var l="暂不支持\n";if(-1===n.style.indexOf("Menu")){var r=1==o.length;l=[n.style,r?"(":"([",o.join(","),r?")":"]);"].join("")}0==o.length&&(l="");var u=$("#menuCommand")[0].selectedIndex,i=n.model.commands[u];if(t)i.active=!1;else{i.active=!0;var s=n.model.commands[u+1];s&&(n.command=s.value)}l=jsFormat(l),n.setText(l,n)},del:function(e,n){n.command in n.selectedCommands&&(n.selectedCommands[n.command]=null,n.add(e,n,!0))},clean:function(e,n){allCommands.forEach(function(e){e.active=!1}),n.selectedCommands={},n.setText("",n)},setText:function(e,n){n.text=e;var t=e.match(/\n/g);n.lineCount=(t?t.length:-1)+1}}));