function jsFormat(e){return js_beautify(e,{indent_size:4,indent_char:" "})}var toString=function(){function e(e){for(var n=0;n<t.length;n+=2)e=e.replace(t[n],t[n+1]);return'"'+e+'"'}function n(t){var r,o;switch(typeof t){case"string":return e(t);case"number":case"boolean":return t+"";case"object":if(!t)return"null";if(r=[],t instanceof Array){if(1==t.length&&null==t[0])return"[null]";for(o=0;o<t.length;o++)r[o]=null==t[o]?"":n(t[o]);return"["+r.join()+"]"}for(o in t)r[r.length]=o+":"+n(t[o]);return"{"+r.join()+"}";case"undefined":return"null";case"function":case"regexp":return t.toString();default:throw Error(typeof t)}}var t=[/(?=["\\])/g,"\\",/\n/g,"\\n",/\r/g,"\\r",/\t/g,"\\t"];return n}(),checkSupport="chrome:"!==location.protocol,AddMenu={selectedStyle:[],init:function(){var e,n;for(var t in Data)e=Data[t],n=e.tooltiptext||e.label,$("#menuCommand").append('<option value="'+t+'" title="'+n+'">'+e.label+"</option>")},changeMenuCommand:function(){var e=0===$("#menuStyle").val().toLowerCase().indexOf("page");Array.filter($("#menuCommand")[0].options,function(n){n.style.display=e?"":"p"==n.value.slice(0,1)?"none":""}),$("#menuCommand")[0].options[0].selected=!0},doNotGenerate:function(){var e=$("#menuStyle").val(),n="暂不支持";if(-1===e.indexOf("Menu")){var t=Data[$("#menuCommand").val()];n=e+"("+jsFormat(toString(t))+");"}$("#AddMenuScript").val(n),$("#scriptLineNum").text("行数:"+($("#AddMenuScript").val().match(/\n/g).length+1))},generateScript:function(){this.selectedStyle[$("#menuStyle").val()]="//"+this[$("#menuCommand").val()].name+"\n"+this[$("#menuCommand").val()].cmd.toString().split("\n").slice(1,-1).join("\n");var e=decodeURIComponent(escape(atob(this.quickDragTemplate)));for(i in this.selectedStyle)e=e.replace("//"+i,this.selectedStyle[i]);$("#MouseDragScript").val(js_beautify(e.replace(/.+[\t ]*\n[\t ]*\/\/...?\n.+\n.+/g,"").replace(/\/\/.\n/g,"")))},openChrome:function(){try{checkSupport&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),Components.classes["@mozilla.org/file/directory_service;1"].getService(Components.interfaces.nsIProperties).get("UChrm",Components.interfaces.nsILocalFile).reveal()}catch(e){this.showNotSupport()}},showNotSupport:function(){alert("about:config中 signed.applets.codebase_principal_support 禁止了该行为")}};AddMenu.init();